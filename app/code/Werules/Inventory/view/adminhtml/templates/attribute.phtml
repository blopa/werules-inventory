<?php
/** @var \Werules\Inventory\Block\Adminhtml\Attribute $block */
$filterableAttributes = $block->getFilterableAttributes();
$selectedAttribute = $block->getSelectedAttribute();
$attributeCosts = $block->getAttributeInventoryCosts();
?>

<h1><?php echo __('Inventory by Attribute'); ?></h1>

<form action="<?php echo $block->getUrl('*/*/*', ['_current' => true, '_use_rewrite' => true]); ?>" method="get">
    <div class="admin__field">
        <label for="attribute_code" class="admin__field-label"><span><?php echo __('Select Attribute'); ?></span></label>
        <div class="admin__field-control">
            <select id="attribute_code" name="attribute_code" class="admin__control-select">
                <option value=""><?php echo __('-- Please Select an Attribute --'); ?></option>
                <?php foreach ($filterableAttributes as $attribute): ?>
                    <option value="<?php echo $attribute->getAttributeCode(); ?>" <?php if ($selectedAttribute == $attribute->getAttributeCode()) echo 'selected'; ?>>
                        <?php echo $block->escapeHtml($attribute->getFrontendLabel()); ?>
                    </option>
                <?php endforeach; ?>
            </select>
        </div>
    </div>
    <div class="admin__field">
        <button type="submit" class="action-primary"><?php echo __('Filter'); ?></button>
    </div>
</form>

<?php if ($selectedAttribute && !empty($attributeCosts)): ?>
    <h2><?php echo __('Results for: %1', $block->escapeHtml($selectedAttribute)); ?></h2>
    <table class="data-grid">
        <thead>
            <tr>
                <th class="data-grid-th"><?php echo __('Attribute Value'); ?></th>
                <th class="data-grid-th"><?php echo __('Total Inventory Cost'); ?></th>
            </tr>
        </thead>
        <tbody>
            <?php foreach ($attributeCosts as $value => $cost): ?>
                <tr>
                    <td><?php echo $block->escapeHtml($value); ?></td>
                    <td><?php echo '$' . number_format($cost, 2); ?></td>
                </tr>
            <?php endforeach; ?>
        </tbody>
    </table>
<?php elseif ($selectedAttribute): ?>
    <p><?php echo __('No inventory costs to display for the selected attribute.'); ?></p>
<?php endif; ?>
